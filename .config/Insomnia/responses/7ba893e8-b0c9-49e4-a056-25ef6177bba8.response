[{"url":"https://api.github.com/repos/facebook/react/issues/20255","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20255/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20255/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20255/events","html_url":"https://github.com/facebook/react/pull/20255","id":742740315,"node_id":"MDExOlB1bGxSZXF1ZXN0NTIwODEwODY3","number":20255,"title":"Bisect effects refactor","user":{"login":"acdlite","id":3624098,"node_id":"MDQ6VXNlcjM2MjQwOTg=","avatar_url":"https://avatars0.githubusercontent.com/u/3624098?v=4","gravatar_id":"","url":"https://api.github.com/users/acdlite","html_url":"https://github.com/acdlite","followers_url":"https://api.github.com/users/acdlite/followers","following_url":"https://api.github.com/users/acdlite/following{/other_user}","gists_url":"https://api.github.com/users/acdlite/gists{/gist_id}","starred_url":"https://api.github.com/users/acdlite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acdlite/subscriptions","organizations_url":"https://api.github.com/users/acdlite/orgs","repos_url":"https://api.github.com/users/acdlite/repos","events_url":"https://api.github.com/users/acdlite/events{/privacy}","received_events_url":"https://api.github.com/users/acdlite/received_events","type":"User","site_admin":false},"labels":[{"id":196858374,"node_id":"MDU6TGFiZWwxOTY4NTgzNzQ=","url":"https://api.github.com/repos/facebook/react/labels/CLA%20Signed","name":"CLA Signed","color":"e7e7e7","default":false,"description":null},{"id":1775958285,"node_id":"MDU6TGFiZWwxNzc1OTU4Mjg1","url":"https://api.github.com/repos/facebook/react/labels/React%20Core%20Team","name":"React Core Team","color":"9149d1","default":false,"description":"Opened by a member of the React Core Team"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-11-13T19:40:29Z","updated_at":"2020-12-02T16:56:28Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/facebook/react/pulls/20255","html_url":"https://github.com/facebook/react/pull/20255","diff_url":"https://github.com/facebook/react/pull/20255.diff","patch_url":"https://github.com/facebook/react/pull/20255.patch"},"body":"**Not for merge; work-in-progress**\r\n\r\nSomething in the new fork is causing a topline metrics regression. We're not sure what it is, so we're going to split it into steps and bisect.\r\n\r\nWe'll use this PR to run syncs to www.","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20248","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20248/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20248/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20248/events","html_url":"https://github.com/facebook/react/issues/20248","id":742650362,"node_id":"MDU6SXNzdWU3NDI2NTAzNjI=","number":20248,"title":"Bug: [eslint-plugin-react-hooks] Constructions should be caught in default props/args","user":{"login":"nstepien","id":567105,"node_id":"MDQ6VXNlcjU2NzEwNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/567105?v=4","gravatar_id":"","url":"https://api.github.com/users/nstepien","html_url":"https://github.com/nstepien","followers_url":"https://api.github.com/users/nstepien/followers","following_url":"https://api.github.com/users/nstepien/following{/other_user}","gists_url":"https://api.github.com/users/nstepien/gists{/gist_id}","starred_url":"https://api.github.com/users/nstepien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nstepien/subscriptions","organizations_url":"https://api.github.com/users/nstepien/orgs","repos_url":"https://api.github.com/users/nstepien/repos","events_url":"https://api.github.com/users/nstepien/events{/privacy}","received_events_url":"https://api.github.com/users/nstepien/received_events","type":"User","site_admin":false},"labels":[{"id":1249821345,"node_id":"MDU6TGFiZWwxMjQ5ODIxMzQ1","url":"https://api.github.com/repos/facebook/react/labels/Component:%20ESLint%20Rules","name":"Component: ESLint Rules","color":"f7afdb","default":false,"description":""},{"id":40929153,"node_id":"MDU6TGFiZWw0MDkyOTE1Mw==","url":"https://api.github.com/repos/facebook/react/labels/Type:%20Enhancement","name":"Type: Enhancement","color":"84b6eb","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-13T17:46:29Z","updated_at":"2020-11-13T18:23:08Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n  Please provide a clear and concise description of what the bug is. Include\r\n  screenshots if needed. Please test using the latest version of the relevant\r\n  React packages to make sure your issue has not already been fixed.\r\n-->\r\n\r\nReact version: 17.0.1\r\n\r\n## Steps To Reproduce\r\n\r\n1. ```js\r\n   function useMyHook1(arr = []) {\r\n     useEffect(() => {\r\n       console.log(arr);\r\n     }, [arr]);\r\n   }\r\n\r\n    function useMyHook2({ arr = [] }) {\r\n     useEffect(() => {\r\n       console.log(arr);\r\n     }, [arr]);\r\n   }\r\n\r\n   function MyComponent({ arr = [] }) {\r\n     useEffect(() => {\r\n       console.log(arr);\r\n     }, [arr]);\r\n\r\n     return null;\r\n   }\r\n   ```\r\n\r\n<!--\r\n  Your bug will get fixed much faster if we can run your code and it doesn't\r\n  have dependencies other than React. Issues without reproduction steps or\r\n  code examples may be immediately closed as not actionable.\r\n-->\r\n\r\nLink to code example: --\r\n\r\n<!--\r\n  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a\r\n  repository on GitHub, or provide a minimal code example that reproduces the\r\n  problem. You may provide a screenshot of the application if you think it is\r\n  relevant to your bug report. Here are some tips for providing a minimal\r\n  example: https://stackoverflow.com/help/mcve.\r\n-->\r\n\r\n## The current behavior\r\nNo warning appears for `arr` being potentially constructed on every render.\r\n\r\n## The expected behavior\r\nShould warn that `arr` can be constructed on each render.\r\nThe lint rules already warn for the following, so this is just an extension of the existing behavior:\r\n```js\r\nconst arr = props.arr ?? []; // The 'arr' logical expression could make the dependencies of useEffect Hook (at line 54) change on every render. Move it inside the useEffect callback. Alternatively, wrap the initialization of 'arr' in its own useMemo() Hook.\r\n```\r\nReference: https://github.com/facebook/react/pull/19590","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20247","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20247/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20247/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20247/events","html_url":"https://github.com/facebook/react/pull/20247","id":742641795,"node_id":"MDExOlB1bGxSZXF1ZXN0NTIwNzI2NjQ2","number":20247,"title":"react-hooks/exhaustive-deps: Handle optional chained methods as dependency (#20204)","user":{"login":"AriPerkkio","id":14806298,"node_id":"MDQ6VXNlcjE0ODA2Mjk4","avatar_url":"https://avatars2.githubusercontent.com/u/14806298?v=4","gravatar_id":"","url":"https://api.github.com/users/AriPerkkio","html_url":"https://github.com/AriPerkkio","followers_url":"https://api.github.com/users/AriPerkkio/followers","following_url":"https://api.github.com/users/AriPerkkio/following{/other_user}","gists_url":"https://api.github.com/users/AriPerkkio/gists{/gist_id}","starred_url":"https://api.github.com/users/AriPerkkio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AriPerkkio/subscriptions","organizations_url":"https://api.github.com/users/AriPerkkio/orgs","repos_url":"https://api.github.com/users/AriPerkkio/repos","events_url":"https://api.github.com/users/AriPerkkio/events{/privacy}","received_events_url":"https://api.github.com/users/AriPerkkio/received_events","type":"User","site_admin":false},"labels":[{"id":196858374,"node_id":"MDU6TGFiZWwxOTY4NTgzNzQ=","url":"https://api.github.com/repos/facebook/react/labels/CLA%20Signed","name":"CLA Signed","color":"e7e7e7","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-11-13T17:37:21Z","updated_at":"2020-12-02T05:21:13Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/facebook/react/pulls/20247","html_url":"https://github.com/facebook/react/pull/20247","diff_url":"https://github.com/facebook/react/pull/20247.diff","patch_url":"https://github.com/facebook/react/pull/20247.patch"},"body":"<!--\r\n  Thanks for submitting a pull request!\r\n  We appreciate you spending the time to work on these changes. Please provide enough information so that others can review your pull request. The three fields below are mandatory.\r\n\r\n  Before submitting a pull request, please make sure the following is done:\r\n\r\n  1. Fork [the repository](https://github.com/facebook/react) and create your branch from `master`.\r\n  2. Run `yarn` in the repository root.\r\n  3. If you've fixed a bug or added code that should be tested, add tests!\r\n  4. Ensure the test suite passes (`yarn test`). Tip: `yarn test --watch TestName` is helpful in development.\r\n  5. Run `yarn test --prod` to test in the production environment. It supports the same options as `yarn test`.\r\n  6. If you need a debugger, run `yarn debug-test --watch TestName`, open `chrome://inspect`, and press \"Inspect\".\r\n  7. Format your code with [prettier](https://github.com/prettier/prettier) (`yarn prettier`).\r\n  8. Make sure your code lints (`yarn lint`). Tip: `yarn linc` to only check changed files.\r\n  9. Run the [Flow](https://flowtype.org/) type checks (`yarn flow`).\r\n  10. If you haven't already, complete the CLA.\r\n\r\n  Learn more about contributing: https://reactjs.org/docs/how-to-contribute.html\r\n-->\r\n\r\n## Summary\r\n\r\n<!-- Explain the **motivation** for making this change. What existing problem does the pull request solve? -->\r\nFixes #20204.\r\n\r\nDependency array parsing crashes when it encounters optional-chained function calls, e.g. `props?.attribute.method()`.\r\n\r\nGiven:\r\n```js\r\nuseEffect(() => {}, [someObject?.optionalField.method()]);\r\n```\r\n\r\nExpected:\r\n- `React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.`\r\n\r\nActual: \r\n- `Cannot read property 'type' of undefined`\r\n- No lint errors are displayed due to linter crash\r\n\r\n\r\n## Test Plan\r\n\r\n<!-- Demonstrate the code is solid. Example: The exact commands you ran and their output, screenshots / videos if the pull request changes the user interface. -->\r\nUnit tests:\r\n- Added missing test for checking function call as dependency: `[props.method()]`\r\n- Added test validating fix. Contains optional-chained function call: `[props?.attribute.method()]`\r\n\r\nRegression:\r\n- Linted [164 repositories](https://github.com/AriPerkkio/eslint-remote-tester/blob/master/eslint-remote-tester.react.config.js#L2-L168) before and after the fix. The only change was that the previously crashing file was no more crashing. Every other lint warning was as before. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20238","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20238/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20238/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20238/events","html_url":"https://github.com/facebook/react/issues/20238","id":741777948,"node_id":"MDU6SXNzdWU3NDE3Nzc5NDg=","number":20238,"title":"Bug: peerDeps react in react-test-renderer has a massive minor bump ","user":{"login":"ktalebian","id":2308915,"node_id":"MDQ6VXNlcjIzMDg5MTU=","avatar_url":"https://avatars2.githubusercontent.com/u/2308915?v=4","gravatar_id":"","url":"https://api.github.com/users/ktalebian","html_url":"https://github.com/ktalebian","followers_url":"https://api.github.com/users/ktalebian/followers","following_url":"https://api.github.com/users/ktalebian/following{/other_user}","gists_url":"https://api.github.com/users/ktalebian/gists{/gist_id}","starred_url":"https://api.github.com/users/ktalebian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktalebian/subscriptions","organizations_url":"https://api.github.com/users/ktalebian/orgs","repos_url":"https://api.github.com/users/ktalebian/repos","events_url":"https://api.github.com/users/ktalebian/events{/privacy}","received_events_url":"https://api.github.com/users/ktalebian/received_events","type":"User","site_admin":false},"labels":[{"id":155984160,"node_id":"MDU6TGFiZWwxNTU5ODQxNjA=","url":"https://api.github.com/repos/facebook/react/labels/Status:%20Unconfirmed","name":"Status: Unconfirmed","color":"d4c5f9","default":false,"description":"A potential issue that we haven't yet confirmed as a bug"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2020-11-12T17:14:49Z","updated_at":"2020-11-12T22:40:51Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Take a look at these two versions of react-test-renderer\r\n\r\n```json\r\n{\r\n  \"name\": \"react-test-renderer\",\r\n  \"version\": \"16.12.0\",\r\n  \"description\": \"React package for snapshot testing.\",\r\n  \"main\": \"index.js\",\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/facebook/react.git\",\r\n    \"directory\": \"packages/react-test-renderer\"\r\n  },\r\n  \"keywords\": [\r\n    \"react\",\r\n    \"react-native\",\r\n    \"react-testing\"\r\n  ],\r\n  \"license\": \"MIT\",\r\n  \"bugs\": {\r\n    \"url\": \"https://github.com/facebook/react/issues\"\r\n  },\r\n  \"homepage\": \"https://reactjs.org/\",\r\n  \"dependencies\": {\r\n    \"object-assign\": \"^4.1.1\",\r\n    \"prop-types\": \"^15.6.2\",\r\n    \"react-is\": \"^16.8.6\",\r\n    \"scheduler\": \"^0.18.0\"\r\n  },\r\n  \"peerDependencies\": {\r\n    \"react\": \"^16.0.0\"\r\n  },\r\n  \"files\": [\r\n    \"LICENSE\",\r\n    \"README.md\",\r\n    \"build-info.json\",\r\n    \"index.js\",\r\n    \"shallow.js\",\r\n    \"cjs/\",\r\n    \"umd/\"\r\n  ]\r\n}\r\n```\r\n\r\nand\r\n\r\n```json\r\n{\r\n  \"name\": \"react-test-renderer\",\r\n  \"version\": \"16.13.1\",\r\n  \"description\": \"React package for snapshot testing.\",\r\n  \"main\": \"index.js\",\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/facebook/react.git\",\r\n    \"directory\": \"packages/react-test-renderer\"\r\n  },\r\n  \"keywords\": [\r\n    \"react\",\r\n    \"react-native\",\r\n    \"react-testing\"\r\n  ],\r\n  \"license\": \"MIT\",\r\n  \"bugs\": {\r\n    \"url\": \"https://github.com/facebook/react/issues\"\r\n  },\r\n  \"homepage\": \"https://reactjs.org/\",\r\n  \"dependencies\": {\r\n    \"object-assign\": \"^4.1.1\",\r\n    \"prop-types\": \"^15.6.2\",\r\n    \"react-is\": \"^16.8.6\",\r\n    \"scheduler\": \"^0.19.1\"\r\n  },\r\n  \"peerDependencies\": {\r\n    \"react\": \"^16.13.1\"\r\n  },\r\n  \"files\": [\r\n    \"LICENSE\",\r\n    \"README.md\",\r\n    \"build-info.json\",\r\n    \"index.js\",\r\n    \"shallow.js\",\r\n    \"cjs/\",\r\n    \"umd/\"\r\n  ]\r\n}\r\n```\r\n\r\nUp until v16.12.0, the peer-dep range of react was my version of react 16. But then in v16.131, this peer dependency jumped to require the same version of the package itself.\r\n\r\nThis is causing issues with the new `npm7` which attempts to auto-resolve peer dependencies. Was this an intentional bump? Is react-test-renderer 16.13.1 not compatible wth say React 16.12.0 any more?","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20237","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20237/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20237/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20237/events","html_url":"https://github.com/facebook/react/issues/20237","id":741774600,"node_id":"MDU6SXNzdWU3NDE3NzQ2MDA=","number":20237,"title":"Bug: v16.14.0 tag is incorrectly shows v17-alpha","user":{"login":"ktalebian","id":2308915,"node_id":"MDQ6VXNlcjIzMDg5MTU=","avatar_url":"https://avatars2.githubusercontent.com/u/2308915?v=4","gravatar_id":"","url":"https://api.github.com/users/ktalebian","html_url":"https://github.com/ktalebian","followers_url":"https://api.github.com/users/ktalebian/followers","following_url":"https://api.github.com/users/ktalebian/following{/other_user}","gists_url":"https://api.github.com/users/ktalebian/gists{/gist_id}","starred_url":"https://api.github.com/users/ktalebian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ktalebian/subscriptions","organizations_url":"https://api.github.com/users/ktalebian/orgs","repos_url":"https://api.github.com/users/ktalebian/repos","events_url":"https://api.github.com/users/ktalebian/events{/privacy}","received_events_url":"https://api.github.com/users/ktalebian/received_events","type":"User","site_admin":false},"labels":[{"id":155984160,"node_id":"MDU6TGFiZWwxNTU5ODQxNjA=","url":"https://api.github.com/repos/facebook/react/labels/Status:%20Unconfirmed","name":"Status: Unconfirmed","color":"d4c5f9","default":false,"description":"A potential issue that we haven't yet confirmed as a bug"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-12T17:10:12Z","updated_at":"2020-11-12T17:11:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"The tag on GitHub does not match the version of the package:\r\n\r\nhttps://github.com/facebook/react/blob/v16.14.0/packages/react-test-renderer/package.json\r\n\r\nThis is v16.14.0, but the package is of version `17.0.0-alpha.0`.\r\n\r\nSame goes for https://github.com/facebook/react/blob/v16.13.1/packages/react-test-renderer/package.json","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20236","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20236/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20236/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20236/events","html_url":"https://github.com/facebook/react/issues/20236","id":741734029,"node_id":"MDU6SXNzdWU3NDE3MzQwMjk=","number":20236,"title":"DevTools: Flag \"nested updates\" in the Profiler UI","user":{"login":"bvaughn","id":29597,"node_id":"MDQ6VXNlcjI5NTk3","avatar_url":"https://avatars0.githubusercontent.com/u/29597?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaughn","html_url":"https://github.com/bvaughn","followers_url":"https://api.github.com/users/bvaughn/followers","following_url":"https://api.github.com/users/bvaughn/following{/other_user}","gists_url":"https://api.github.com/users/bvaughn/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaughn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaughn/subscriptions","organizations_url":"https://api.github.com/users/bvaughn/orgs","repos_url":"https://api.github.com/users/bvaughn/repos","events_url":"https://api.github.com/users/bvaughn/events{/privacy}","received_events_url":"https://api.github.com/users/bvaughn/received_events","type":"User","site_admin":false},"labels":[{"id":710573595,"node_id":"MDU6TGFiZWw3MTA1NzM1OTU=","url":"https://api.github.com/repos/facebook/react/labels/Component:%20Developer%20Tools","name":"Component: Developer Tools","color":"fbca04","default":false,"description":null}],"state":"open","locked":false,"assignee":{"login":"bvaughn","id":29597,"node_id":"MDQ6VXNlcjI5NTk3","avatar_url":"https://avatars0.githubusercontent.com/u/29597?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaughn","html_url":"https://github.com/bvaughn","followers_url":"https://api.github.com/users/bvaughn/followers","following_url":"https://api.github.com/users/bvaughn/following{/other_user}","gists_url":"https://api.github.com/users/bvaughn/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaughn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaughn/subscriptions","organizations_url":"https://api.github.com/users/bvaughn/orgs","repos_url":"https://api.github.com/users/bvaughn/repos","events_url":"https://api.github.com/users/bvaughn/events{/privacy}","received_events_url":"https://api.github.com/users/bvaughn/received_events","type":"User","site_admin":false},"assignees":[{"login":"bvaughn","id":29597,"node_id":"MDQ6VXNlcjI5NTk3","avatar_url":"https://avatars0.githubusercontent.com/u/29597?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaughn","html_url":"https://github.com/bvaughn","followers_url":"https://api.github.com/users/bvaughn/followers","following_url":"https://api.github.com/users/bvaughn/following{/other_user}","gists_url":"https://api.github.com/users/bvaughn/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaughn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaughn/subscriptions","organizations_url":"https://api.github.com/users/bvaughn/orgs","repos_url":"https://api.github.com/users/bvaughn/repos","events_url":"https://api.github.com/users/bvaughn/events{/privacy}","received_events_url":"https://api.github.com/users/bvaughn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-11-12T16:17:08Z","updated_at":"2020-11-13T14:12:30Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"PR #20163 added a new (not yet released) phase to the Profiler API: `\"nested-update\"`. This phase is different from a regular `\"update\"` because of the performance implications (see PR description for more background info).\r\n\r\nWould be nice if we could also flag these in the DevTools UI somehow.","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20235","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20235/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20235/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20235/events","html_url":"https://github.com/facebook/react/issues/20235","id":741698020,"node_id":"MDU6SXNzdWU3NDE2OTgwMjA=","number":20235,"title":"Bug: Cannot import 'react/jsx-runtime' from esm node/webpack 5","user":{"login":"nstepien","id":567105,"node_id":"MDQ6VXNlcjU2NzEwNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/567105?v=4","gravatar_id":"","url":"https://api.github.com/users/nstepien","html_url":"https://github.com/nstepien","followers_url":"https://api.github.com/users/nstepien/followers","following_url":"https://api.github.com/users/nstepien/following{/other_user}","gists_url":"https://api.github.com/users/nstepien/gists{/gist_id}","starred_url":"https://api.github.com/users/nstepien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nstepien/subscriptions","organizations_url":"https://api.github.com/users/nstepien/orgs","repos_url":"https://api.github.com/users/nstepien/repos","events_url":"https://api.github.com/users/nstepien/events{/privacy}","received_events_url":"https://api.github.com/users/nstepien/received_events","type":"User","site_admin":false},"labels":[{"id":620368407,"node_id":"MDU6TGFiZWw2MjAzNjg0MDc=","url":"https://api.github.com/repos/facebook/react/labels/Resolution:%20Needs%20More%20Information","name":"Resolution: Needs More Information","color":"fffde7","default":false,"description":null},{"id":155984160,"node_id":"MDU6TGFiZWwxNTU5ODQxNjA=","url":"https://api.github.com/repos/facebook/react/labels/Status:%20Unconfirmed","name":"Status: Unconfirmed","color":"d4c5f9","default":false,"description":"A potential issue that we haven't yet confirmed as a bug"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2020-11-12T15:31:54Z","updated_at":"2020-11-27T12:18:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n  Please provide a clear and concise description of what the bug is. Include\r\n  screenshots if needed. Please test using the latest version of the relevant\r\n  React packages to make sure your issue has not already been fixed.\r\n-->\r\n\r\nReact version: 17.0.1\r\n\r\n## Steps To Reproduce\r\n\r\n1. Create a new directory, `cd` to it.\r\n2. Run `npm i react@17 webpack@5 webpack-cli@4`\r\n3. Create `index.mjs` with the following content:\r\n   ```js\r\n   import * as jsx from 'react/jsx-runtime';\r\n   console.log(jsx);\r\n   ```\r\n4. Run `node index.mjs`\r\n5. Run `npx webpack-cli path/to/index.mjs`\r\n   - I had to use an absolute path on my machine or webpack-cli wouldn't find `index.mjs`, don't know why.\r\n\r\n<!--\r\n  Your bug will get fixed much faster if we can run your code and it doesn't\r\n  have dependencies other than React. Issues without reproduction steps or\r\n  code examples may be immediately closed as not actionable.\r\n-->\r\n\r\nLink to code example: --\r\n\r\n<!--\r\n  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a\r\n  repository on GitHub, or provide a minimal code example that reproduces the\r\n  problem. You may provide a screenshot of the application if you think it is\r\n  relevant to your bug report. Here are some tips for providing a minimal\r\n  example: https://stackoverflow.com/help/mcve.\r\n-->\r\n\r\n## The current behavior\r\n```\r\n> node index.mjs\r\nnode:internal/process/esm_loader:74\r\n    internalBinding('errors').triggerUncaughtException(\r\n                              ^\r\n\r\nError [ERR_MODULE_NOT_FOUND]: Cannot find module 'D:\\repos\\jsx\\node_modules\\react\\jsx-runtime' imported from D:\\repos\\jsx\\index.mjs\r\nDid you mean to import react/jsx-runtime.js?\r\n    at new NodeError (node:internal/errors:277:15)\r\n    at finalizeResolution (node:internal/modules/esm/resolve:307:11)\r\n    at moduleResolve (node:internal/modules/esm/resolve:742:10)\r\n    at Loader.defaultResolve [as _resolve] (node:internal/modules/esm/resolve:853:11)\r\n    at Loader.resolve (node:internal/modules/esm/loader:85:40)\r\n    at Loader.getModuleJob (node:internal/modules/esm/loader:229:28)\r\n    at ModuleWrap.<anonymous> (node:internal/modules/esm/module_job:51:40)\r\n    at link (node:internal/modules/esm/module_job:50:36) {\r\n  code: 'ERR_MODULE_NOT_FOUND'\r\n}\r\n```\r\n```\r\n> npx webpack-cli D:\\repos\\jsx\\index.mjs\r\n[webpack-cli] Compilation finished\r\nassets by status 264 bytes [cached] 1 asset\r\n./index.mjs 64 bytes [built] [code generated]\r\n\r\nERROR in ./index.mjs 1:0-41\r\nModule not found: Error: Can't resolve 'react/jsx-runtime' in 'D:\\repos\\jsx'\r\nDid you mean 'jsx-runtime.js'?\r\nBREAKING CHANGE: The request 'react/jsx-runtime' failed to resolve only because it was resolved as fully specified\r\n(probably because the origin is a '*.mjs' file or a '*.js' file where the package.json contains '\"type\": \"module\"').\r\nThe extension in the request is mandatory for it to be fully specified.\r\nAdd the extension to the request.\r\n\r\nwebpack 5.4.0 compiled with 1 error in 150 ms\r\nnpm ERR! code 1\r\n```\r\n\r\n## The expected behavior\r\nNo issues importing `react/jsx-runtime` with no file extensions.\r\n\r\nI can think of two solutions:\r\n- Fix babel, typescript, and all the other tools that automatically add the import to add the file extension.\r\n  - That ship has sailed though, I don't think this is right thing to do.\r\n- Add the `exports` field in react's `package.json`.\r\n  - This could also open the door to supporting prod/dev builds without depending on `process.env.NODE_ENV` for bundlers.\r\n  - More discussion here: https://github.com/facebook/react/issues/11503#issuecomment-717589904\r\n  - https://nodejs.org/dist/latest/docs/api/packages.html\r\n  - https://webpack.js.org/guides/package-exports/","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20233","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20233/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20233/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20233/events","html_url":"https://github.com/facebook/react/pull/20233","id":741357419,"node_id":"MDExOlB1bGxSZXF1ZXN0NTE5Njg1NDQ3","number":20233,"title":"Untangle circular dependencies, the sequel","user":{"login":"matthargett","id":1550766,"node_id":"MDQ6VXNlcjE1NTA3NjY=","avatar_url":"https://avatars3.githubusercontent.com/u/1550766?v=4","gravatar_id":"","url":"https://api.github.com/users/matthargett","html_url":"https://github.com/matthargett","followers_url":"https://api.github.com/users/matthargett/followers","following_url":"https://api.github.com/users/matthargett/following{/other_user}","gists_url":"https://api.github.com/users/matthargett/gists{/gist_id}","starred_url":"https://api.github.com/users/matthargett/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthargett/subscriptions","organizations_url":"https://api.github.com/users/matthargett/orgs","repos_url":"https://api.github.com/users/matthargett/repos","events_url":"https://api.github.com/users/matthargett/events{/privacy}","received_events_url":"https://api.github.com/users/matthargett/received_events","type":"User","site_admin":false},"labels":[{"id":196858374,"node_id":"MDU6TGFiZWwxOTY4NTgzNzQ=","url":"https://api.github.com/repos/facebook/react/labels/CLA%20Signed","name":"CLA Signed","color":"e7e7e7","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-11-12T07:35:53Z","updated_at":"2020-11-12T20:28:31Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/facebook/react/pulls/20233","html_url":"https://github.com/facebook/react/pull/20233","diff_url":"https://github.com/facebook/react/pull/20233.diff","patch_url":"https://github.com/facebook/react/pull/20233.patch"},"body":"<!--\r\n  Thanks for submitting a pull request!\r\n  We appreciate you spending the time to work on these changes. Please provide enough information so that others can review your pull request. The three fields below are mandatory.\r\n\r\n  Before submitting a pull request, please make sure the following is done:\r\n\r\n  1. Fork [the repository](https://github.com/facebook/react) and create your branch from `master`.\r\n  2. Run `yarn` in the repository root.\r\n  3. If you've fixed a bug or added code that should be tested, add tests!\r\n  4. Ensure the test suite passes (`yarn test`). Tip: `yarn test --watch TestName` is helpful in development.\r\n  5. Run `yarn test --prod` to test in the production environment. It supports the same options as `yarn test`.\r\n  6. If you need a debugger, run `yarn debug-test --watch TestName`, open `chrome://inspect`, and press \"Inspect\".\r\n  7. Format your code with [prettier](https://github.com/prettier/prettier) (`yarn prettier`).\r\n  8. Make sure your code lints (`yarn lint`). Tip: `yarn linc` to only check changed files.\r\n  9. Run the [Flow](https://flowtype.org/) type checks (`yarn flow`).\r\n  10. If you haven't already, complete the CLA.\r\n\r\n  Learn more about contributing: https://reactjs.org/docs/how-to-contribute.html\r\n-->\r\n\r\n## Summary\r\n\r\n<!-- Explain the **motivation** for making this change. What existing problem does the pull request solve? -->\r\nAfter discussion with @gaearon , and iterating in PRs #19997 and #19971 , this should balance all the feedback and constraints.\r\n\r\nAt its core, this approach removes the type definitions from the ReactCurrent* and makes the polymorphism late-binding via (future) type checks at runtime (presumably in __DEV__ mode). This eliminates the root of most of the type import cycle.\r\n\r\nThe other type import cycle was LazyComponent, which I moved to be alongside the other component type definitions. Looking at the resulting changes in import statements, this looks like is coheres better and follows the convention of storing those component typedefs in that file.\r\n\r\nI did not remove the cyclical dependency workarounds in the jest and rollup scripts, to keep this PR small.\r\n\r\nThanks again for taking the time to review and discuss.\r\n\r\n## Test Plan\r\nI ran `yarn test`, `yarn flow dom|dom-relay|test|fabric`, and `yarn lint`.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20228","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20228/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20228/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20228/events","html_url":"https://github.com/facebook/react/pull/20228","id":741266640,"node_id":"MDExOlB1bGxSZXF1ZXN0NTE5NjA5ODg5","number":20228,"title":"[Flight] Minimal webpack plugin","user":{"login":"gaearon","id":810438,"node_id":"MDQ6VXNlcjgxMDQzOA==","avatar_url":"https://avatars0.githubusercontent.com/u/810438?v=4","gravatar_id":"","url":"https://api.github.com/users/gaearon","html_url":"https://github.com/gaearon","followers_url":"https://api.github.com/users/gaearon/followers","following_url":"https://api.github.com/users/gaearon/following{/other_user}","gists_url":"https://api.github.com/users/gaearon/gists{/gist_id}","starred_url":"https://api.github.com/users/gaearon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaearon/subscriptions","organizations_url":"https://api.github.com/users/gaearon/orgs","repos_url":"https://api.github.com/users/gaearon/repos","events_url":"https://api.github.com/users/gaearon/events{/privacy}","received_events_url":"https://api.github.com/users/gaearon/received_events","type":"User","site_admin":false},"labels":[{"id":196858374,"node_id":"MDU6TGFiZWwxOTY4NTgzNzQ=","url":"https://api.github.com/repos/facebook/react/labels/CLA%20Signed","name":"CLA Signed","color":"e7e7e7","default":false,"description":null},{"id":1775958285,"node_id":"MDU6TGFiZWwxNzc1OTU4Mjg1","url":"https://api.github.com/repos/facebook/react/labels/React%20Core%20Team","name":"React Core Team","color":"9149d1","default":false,"description":"Opened by a member of the React Core Team"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2020-11-12T04:23:48Z","updated_at":"2020-11-12T17:01:40Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/facebook/react/pulls/20228","html_url":"https://github.com/facebook/react/pull/20228","diff_url":"https://github.com/facebook/react/pull/20228.diff","patch_url":"https://github.com/facebook/react/pull/20228.patch"},"body":"MVP to get the fixture running.\r\n\r\nA more idiomatic way would probably be to emit it using the webpack emit API. But then it doesn't get written to disk during development so we'd have to teach Node to ask the webpack dev server for it.\r\n\r\nTested by adding a new `.client.js` file and verified it's hooked up.","performed_via_github_app":null},{"url":"https://api.github.com/repos/facebook/react/issues/20222","repository_url":"https://api.github.com/repos/facebook/react","labels_url":"https://api.github.com/repos/facebook/react/issues/20222/labels{/name}","comments_url":"https://api.github.com/repos/facebook/react/issues/20222/comments","events_url":"https://api.github.com/repos/facebook/react/issues/20222/events","html_url":"https://github.com/facebook/react/issues/20222","id":740731398,"node_id":"MDU6SXNzdWU3NDA3MzEzOTg=","number":20222,"title":"Can I use mountReducer to refactor mountState?","user":{"login":"sweetliquid","id":18693190,"node_id":"MDQ6VXNlcjE4NjkzMTkw","avatar_url":"https://avatars1.githubusercontent.com/u/18693190?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetliquid","html_url":"https://github.com/sweetliquid","followers_url":"https://api.github.com/users/sweetliquid/followers","following_url":"https://api.github.com/users/sweetliquid/following{/other_user}","gists_url":"https://api.github.com/users/sweetliquid/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetliquid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetliquid/subscriptions","organizations_url":"https://api.github.com/users/sweetliquid/orgs","repos_url":"https://api.github.com/users/sweetliquid/repos","events_url":"https://api.github.com/users/sweetliquid/events{/privacy}","received_events_url":"https://api.github.com/users/sweetliquid/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-11T12:32:06Z","updated_at":"2020-11-29T01:40:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I noticed that `updateState` uses `updateReducer` internally like this:\r\n\r\nhttps://github.com/facebook/react/blob/12627f93b5357032881412abcc014da53a0b70f8/packages/react-reconciler/src/ReactFiberHooks.old.js#L1139-L1143\r\n\r\nbut in `mountState`, it was reimplemented:\r\n\r\nhttps://github.com/facebook/react/blob/12627f93b5357032881412abcc014da53a0b70f8/packages/react-reconciler/src/ReactFiberHooks.old.js#L1114-L1137\r\n\r\nCan I refactor `mountState` to use `mountReducer`?\r\n\r\n```javascript\r\nfunction mountState<S>(\r\n  initialState: (() => S) | S,\r\n): [S, Dispatch<BasicStateAction<S>>] {\r\n  if (typeof initialState === 'function') {\r\n    // $FlowFixMe: Flow doesn't like mixed types\r\n    initialState = initialState();\r\n  }\r\n\r\n  return mountReducer(basicStateReducer, initialState);\r\n}\r\n```","performed_via_github_app":null}]